<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Refugee</title>
<link rel="stylesheet" th:href="@{/resources/css/foundation.css}" />


<script>
function checkedActivity(){
	var activityCategoryId = "12";
	var selectedCategory = document.getElementById("chooseCategory");
	document.getElementById('categoryId').value=activityCategoryId;
	selectedCategory.style.visibility = 'hidden';
}

function checkedArticle(){
	var selectedCategory = document.getElementById("chooseCategory");
	selectedCategory.style.visibility = 'initial';
}

</script>
</head>

<body>

	<nav th:include="topbar :: topbar"></nav>

	<div class="row">
		<div class="large-12 columns">
			<p>&nbsp;</p>
			<h4 class="header" th:text="#{newarticle.createarticle}">Angebot einstellen</h4>
			<form action="#" th:action="@{/newArticle}" th:object="${NewArticleForm}" method="post" enctype="multipart/form-data">
				<div class="panel">
					<div class="row">
						<div class="medium-4 mall-12 columns" th:text="#{newarticle.newarticlequestion}">Möchten Sie eine Aktivität (z.b. Sprachkurs, Stadtausflug, Bowlingspiel) oder einen Artikel erstellen?</div>
						<div class="medium-8 small-12 columns">
							<label><font color="red" th:if="${#fields.hasErrors('kind')}" th:errors="*{kind}"> ERROR MESSAGE</font></label>
							<div class="chooseRole">
								<input id="activity" type="radio" name="kind" value="activity" onclick="checkedActivity()"/>
								<font color="#2ba6cb" for="activity" th:text="Aktivität"></font>
								<input id="article" type="radio" name="kind" value="article" onclick="checkedArticle()" />
								<font color="#2ba6cb" for="article" th:text="Artikel"></font>
								<br/>
							</div>
						</div>
					</div>
					<br></br>
					<div class="row" id="chooseCategory">
						<div class="show-for-medium-up">
							<div class="small-4 columns" th:text="#{newarticle.category}">Kategorie:</div>
						</div>
						<div class="medium-8 small-12 columns">
							<select name="categoryId" id="categoryId">
								<div th:each="entry : ${categories}">
									<option th:value="${entry.cat.id}"><div th:text="${entry.cat.name}"></div></option>	
									<option th:each="subEntry : ${entry.subcats}" th:value="${subEntry.id}"><div th:text="'--' +${subEntry.name}"></div></option>	
								</div>
								<!--   <option th:each="categoryForm : ${categoriesForm}" th:value="${categoryForm.id}"><div th:text="${categoryForm.name}"></div></option>		
								-->
							</select>
						</div>
					</div>
					<hr />
					<div class="row">
						<div class="show-for-medium-up">
							<div class="small-4 columns" th:text="#{newarticle.offertitle}">Titel der Anzeige</div>
						</div>
						<div class="medium-8 small-12 columns">
							<label ><font color="red" th:if="${#fields.hasErrors('title')}" th:errors="*{title}"> ERROR MESSAGE</font></label>
							<input type="text" name="title" placeholder="Titel" />
						</div>
					</div>
					<div class="row">
						<div class="show-for-medium-up">
							<div class="small-4 columns" th:text="#{newarticle.description}">Beschreibung</div>
						</div>
						<div class="medium-8 small-12 columns">
							<textarea name="description" rows="4" placeholder="Beschreibung"></textarea>
						</div>
					</div>
					<div class="row">
						<div class="medium-4 small-2 columns" th:text="#{newarticle.pictures}">Bilder</div>
						<div class="medium-8 small-10 columns">
							<a><input type="file" name="file"/></a>
						</div>
					</div>
					<hr />
					<div class="row">
						<div class="show-for-medium-up">
							<div class="small-4 columns" th:text="#{newarticle.city}">Stadt</div>
						</div>
						<div class="medium-8 small-12 columns">										
							<input type="text" name="city" id="city" placeholder="Stadt" th:value="${creator.city}" onchange="getCoords()"/>
						</div>
					</div>
					<div class="row">
						<div class="show-for-medium-up">
							<div class="small-4 columns" th:text="#{newarticle.zipcode}">PLZ</div>
						</div>
						<div class="medium-8 small-12 columns">										
							<input type="text" name="zip" id="zip" placeholder="PLZ" th:value="${creator.zip}" onchange="getCoords()"/>
						</div>
					</div>
					<div class="row">
						<div class="show-for-medium-up">
							<div class="small-4 columns" th:text="#{usersettings.address}">Straße, Addresszusatz</div>
						</div>
						<div class="medium-8 small-12 columns">
							<input type="text" name="streetName" id="street" placeholder="Straßenname" th:value="${creator.streetName}" onchange="getCoords()"/>
							<input type="text" name="addressAddition" id="addition" placeholder="(optional)" onchange="getCoords()" />
						</div>
					</div>					
				</div>

		 		<input type="hidden" name="latitude" id="latitude" value="0"/>
				<input type="hidden" name="longitude" id="longitude" value="0" />
				

				<button class="right button" type="submit" th:href="@{/}" th:text="#{newarticle.createoffer}">Angebot erstellen</button>

			</form>
		</div>
	</div>

	<footer th:include="footer :: footer"></footer>

<!-- Ortsübergabe -->
<script type="text/javascript">
 function getCoords() {
	//Abfrage der eingegeben Adresse
	var address = document.getElementById("zip").value+" "+document.getElementById("city").value+" "+document.getElementById("street").value;
	var geocoder = new google.maps.Geocoder(); 
	geocoder.geocode({'address': address}, function(results, status) {
		if (status === google.maps.GeocoderStatus.OK) {
	     var lat = results[0].geometry.location.lat();
	     var lng = results[0].geometry.location.lng();
	   //übergabe an die input felder
	 	document.getElementById("latitude").value=lat;
	 	document.getElementById("longitude").value=lng; }
		else {
		      alert('Bitte geben sie eine richtig Adresse ein!');
	  	}
	}
	);

	
	
}




</script>




<!-- Google Maps -->
<script  th:src="@{https://maps.googleapis.com/maps/api/js?key=AIzaSyAXULGtfv96afP6mTq9W294gKRlIVr3EMk&amp;signed_in=true&amp;callback=initMap}" async="async" defer="defer"></script>
 

</body>
</html>